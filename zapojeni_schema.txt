# ZAPOJENÍ SCHÉMA - Arduino Rotátor verze 2.0 (UNO + NANO, 1-wire UART)

## Proč verze 2.0
Původní analogová větev (A0 přes ~30 m kabel) může být citlivá na rušení od motoru a 230 V.
Verze 2.0 proto měří potenciometr lokálně na NANO a do UNO posílá pouze digitální data po 1 vodiči (open-collector).

> Původní analogové schéma je zachováno v `legacy/zapojeni_schema_v1.txt`.

---

## A) Strana NANO (u rotátoru) – vysílač open-collector

### Potenciometr
```
NANO Pin        Potenciometr    Popis
--------        ------------    -----
5V              Pin 1           Napájení
A0              Pin 2           Jezdec
GND             Pin 3           Zem
```

### DATA výstup přes NPN tranzistor
```
NANO D8 (TX) ----[1k]----B   NPN (2N2222 / BC337)
                           C---- DATA vodič do kabelu
GND -----------------------E
```

- Vysílač je open-collector (aktivně tahá DATA k zemi).
- Pokud je třeba, lze použít i 2N7000, ale primárně je doporučen NPN dle schématu.

---

## B) Strana UNO (v shacku) – přijímač

### DATA vstup + pull-up
```
DATA vodič ----[1k]---- UNO D8 (RX, SoftwareSerial)
      |
     [4k7]
      |
     +5V
```

- Pull-up pouze na straně UNO.
- TX pro UNO diagnostiku: D9 (volitelné, běžně nepoužité).
- GND mezi UNO a NANO musí být společná.

---

## C) Napájení po 3 žilách

```
Žíla 1: GND      -> společná zem UNO + NANO
Žíla 2: +V       -> 5 až 12 V směrem k NANO (při >5 V použít step-down na 5 V)
Žíla 3: DATA     -> 1-wire UART open-collector
```

Doporučení pro 30 m kabel:
- Pull-up 4k7 je výchozí.
- Pokud jsou hrany pomalé, zkus 2k2.
- Vést DATA co nejdál od 230 V vodičů.

---

## ZAPOJENÍ PINŮ ARDUINO UNO (v2)

### UNO → TFT ST7789V
```
Arduino Pin    TFT Pin    Popis
-----------    -------    -----
5V             VCC        Napájení
GND            GND        Zem
Pin 10         CS         Chip Select
A1             DC         Data/Command
A2             RST        Reset
Pin 11 (MOSI)  SDA        Serial Data
Pin 13 (SCK)   SCL        Serial Clock
```

### UNO → Relé moduly (aktivní LOW)
```
Arduino Pin    Relé Pin    Popis
-----------    ---------    -----
Pin 2          IN1          Blokace směru doleva
Pin 3          IN2          Blokace směru doprava
5V             VCC          Napájení relé
GND            GND          Zem relé
```

### UNO → Piezo
```
Arduino Pin    Piezo    Popis
-----------    -----    -----
Pin 7          +        Pozitivní vývod
GND            -        Negativní vývod
```

---

## Bezpečnost
- Kombinace 230 V a nízkonapěťové signalizace v jednom kabelu je riziková.
- Dodrž oddělení, izolaci a lokální normy.
- Při ztrátě dat (timeout) UNO přechází do FAIL-SAFE: obě relé blokována, stav ERROR.
